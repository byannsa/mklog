<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>MK LOG</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}" />
  </head>

  <body>
    <div class="container white-container">
      <header
        class="header d-flex align-items-center justify-content-between my-4">
        <div class="header-left d-flex align-items-center gap-3">
          <img
            src="{{ url_for('static', filename='assets/log.png') }}"
            alt="Logo"
            class="logo" />
          <h1></h1>
        </div>
        <div class="header-right">
          <span class="username me-3">Halo, {{ nama }}</span>
          <a href="{{ url_for('logout') }}" class="btn btn-logout btn-sm"
            >Logout</a
          >
        </div>
      </header>

      <!-- Tombol untuk buka modal -->
      <button
        class="btn btn-success mb-3"
        data-bs-toggle="modal"
        data-bs-target="#absenModal">
        Absen Sekarang
      </button>

      <!-- Modal Formulir Absensi -->
      <div
        class="modal fade"
        id="absenModal"
        tabindex="-1"
        aria-labelledby="absenModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <form
              id="absenForm"
              action="{{ url_for('absen_siswa') }}"
              method="POST">
              <div class="modal-body row">
                <div class="col-md-6 position-relative">
                  <video
                    id="video"
                    width="100%"
                    height="auto"
                    autoplay
                    style="border-radius: 12px; background: #222"></video>
                  <canvas id="canvas" style="display: none"></canvas>
                  <input type="hidden" name="foto" id="fotoInput" />
                  <button
                    type="button"
                    class="btn btn-success mt-2 w-100"
                    id="ambilFotoBtn">
                    Ambil Foto
                  </button>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Nama</label>
                    <input
                      type="text"
                      class="form-control"
                      value="{{ nama }}"
                      readonly />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Kelas</label>
                    <input
                      type="text"
                      class="form-control"
                      value="{{ kelas }}"
                      readonly />
                  </div>
                  <button
                    type="submit"
                    class="btn btn-dark w-100"
                    id="submitAbsen">
                    Absen Sekarang
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Slider -->
      <div class="slider" aria-label="Informasi Slider">
        <div class="slides position-relative" style="height: 110px">
          <div class="slide active">
            <h2>Selamat Datang di MK LOG</h2>
            <p>Absensi Masa Depan, Akurat Tanpa Kecurangan.</p>
          </div>
          <div class="slide">
            <h2>Sistem Data Absensi Terpercaya No. 1 di Dunia</h2>
            <p>
              Pastikan data kehadiran tercatat dengan benar dan akurat setiap
              saat.
            </p>
          </div>
          <div class="slide">
            <h2>Butuh Bantuan?</h2>
            <p>
              Hubungi Customer Service 24 jam untuk dukungan cepat dan
              responsif.
            </p>
          </div>
        </div>
        <div class="slider-controls">
          <button id="prevBtn" aria-label="Slide sebelumnya"></button>
          <button id="nextBtn" aria-label="Slide berikutnya"></button>
        </div>
      </div>

      <!-- Gambar Mitra -->
      <div
        class="mt-5 text-center"
        style="padding-left: 10px; padding-right: 10px">
        <h5 class="mb-4">Future Attendance, Accurate Without Cheating</h5>
        <img
          src="{{ url_for('static', filename='assets/mitra.png') }}"
          alt="Mitra MK LOG"
          class="mitra-img" />
      </div>
      <style>
        .mitra-img {
          width: 100%;
          height: auto;
          display: block;
          margin: 0 auto;
        }
      </style>

      <!-- Tentang MK LOG -->
      <section class="tentang-kami my-5 p-4 bg-light rounded">
        <div class="row align-items-center">
          <div class="col-md-4 text-center mb-3 mb-md-0">
            <img
              src="{{ url_for('static', filename='assets/log.png') }}"
              alt="MK LOG"
              class="img-fluid"
              style="max-width: 218px" />
          </div>
          <div class="col-md-8">
            <h3>Tentang MK LOG</h3>
            <p>
              MK LOG adalah sistem absensi di dunia pendidikan yang menggunakan
              teknologi terbarukan dan canggih, yaitu pengenalan wajah, untuk
              mencatat kehadiran secara cepat dan akurat. Sistem ini memudahkan
              pengelolaan data absensi dan mengurangi kecurangan.
            </p>
          </div>
        </div>
      </section>

      <section class="tentang-kami my-5 p-4 bg-light rounded">
        <div class="row">
          <!-- Kelebihan MK LOG -->
          <div class="col-md-8 keunggulan-box">
            <h3>Kelebihan MK LOG</h3>
            <p>
              Aplikasi absensi berbasis face recognition yang dirancang untuk
              memberikan kemudahan dan keakuratan dalam mencatat kehadiran.
              Dengan dukungan teknologi pengenalan wajah yang canggih, proses
              absensi menjadi lebih cepat dan akurat tanpa kontak fisik. Sistem
              ini juga mampu mencegah berbagai bentuk kecurangan seperti titip
              absen, sehingga kehadiran tercatat dengan valid.
            </p>
            <p>
              Antarmuka yang sederhana dan ramah pengguna memudahkan guru maupun
              siswa dalam mengoperasikan aplikasi ini. Seluruh data kehadiran
              tersimpan secara terintegrasi, rapi, dan dapat diakses kapan saja.
              Didukung oleh algoritma AI terkini, MK LOG menjamin performa
              optimal dan keandalan tinggi dalam setiap proses absensi.
            </p>
          </div>
          <!-- Gambar M.png -->
          <div class="col-md-4 position-relative">
            <img
              src="{{ url_for('static', filename='assets/M.png') }}"
              alt="Gambar M"
              class="gambar-pojok-kanan" />
          </div>
        </div>
      </section>

      <section class="fitur-utama my-5 p-4 bg-white rounded shadow-sm">
        <div class="row align-items-center">
          <div class="col-md-4">
            <img
              src="{{ url_for('static', filename='assets/K.png') }}"
              alt="Gambar K"
              class="img-fluid"
              style="max-width: 300px" />
          </div>
          <div class="col-md-8">
            <h3>Fitur Utama MK LOG</h3>
            <p>
              Absensi wajah otomatis menggunakan teknologi face recognition
              untuk absensi cepat dan akurat. Laporan lengkap menyediakan data
              absensi harian, mingguan, dan bulanan yang mudah diakses.
              Notifikasi real-time memberikan pemberitahuan langsung saat siswa
              melakukan absensi. Manajemen pengguna memungkinkan pengelolaan
              data siswa dan guru dengan mudah oleh admin. Ekspor data
              memungkinkan ekspor data absensi ke Excel dan PDF untuk analisis
              lebih lanjut.
            </p>
          </div>
        </div>
      </section>
      <style>
        .fitur-utama {
          background-color: #ffffff;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .fitur-utama p {
          font-size: 1rem;
          color: #333;
          line-height: 1.6;
        }
      </style>

      <!-- Gambar figma.png di tengah -->
      <div class="text-center my-5">
        <img
          src="{{ url_for('static', filename='assets/figma.png') }}"
          alt="Figma"
          class="img-fluid"
          style="max-width: 900px" />
        <h5 class="mt-3">Integritas dan Inovasi dalam Sistem Absensi Modern</h5>
      </div>

      <section class="cara-penggunaan my-5 p-4 bg-light rounded shadow-sm">
        <div class="container">
          <h3 class="mb-4 text-center">Cara Penggunaan MK LOG</h3>
          <div class="row g-4">
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/langkah1.png') }}"
                alt="Langkah 1"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>1. Login ke Sistem</h5>
              <p>
                Masuk ke akun Anda menggunakan username dan password yang telah
                diberikan.
              </p>
            </div>
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/langkah2.png') }}"
                alt="Langkah 2"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>2. Lakukan Absensi Wajah</h5>
              <p>
                Arahkan wajah ke kamera untuk verifikasi otomatis menggunakan
                teknologi face recognition.
              </p>
            </div>
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/langkah3.png') }}"
                alt="Langkah 3"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>3. Cek Status Absensi</h5>
              <p>
                Setelah berhasil, Anda dapat melihat status kehadiran Anda
                secara real-time di dashboard.
              </p>
            </div>
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/langkah4.png') }}"
                alt="Langkah 4"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>4. Unduh Laporan</h5>
              <p>
                Admin dapat mengunduh laporan absensi dalam format Excel atau
                PDF untuk kebutuhan analisis.
              </p>
            </div>
          </div>
        </div>
      </section>
      <style>
        .tentang-kami {
          position: relative;
          background-color: #ffffff;
        }
        .gambar-pojok-kanan {
          position: absolute;
          bottom: -37px;
          right: 5px;
          max-width: 267px;
          height: auto;
          background: transparent;
          box-shadow: none;
          border: none;
        }
      </style>

      <!-- Keamanan dan Pencegahan Kecurangan -->
      <section class="keamanan-kecurangan my-5 p-4 bg-white rounded shadow-sm">
        <div class="container">
          <h3 class="mb-4 text-center">
            Keamanan dan Pencegahan Kecurangan MK LOG
          </h3>
          <div class="row g-4 justify-content-center">
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/security.png') }}"
                alt="Keamanan Data"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>Keamanan Data</h5>
              <p>
                Data absensi tersimpan aman dengan enkripsi dan proteksi sistem
                yang ketat.
              </p>
            </div>
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/face-recognition.png') }}"
                alt="Verifikasi Wajah"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>Laporan Verifikasi Foto</h5>
              <p>
                Teknologi face recognition mencegah titip absen dan penggunaan
                wajah palsu.
              </p>
            </div>
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/alert.png') }}"
                alt="Deteksi Kecurangan"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>Sistem Admin</h5>
              <p>
                Admin dapat mendeteksi dan mengelola upaya kecurangan absensi
                dengan mudah.
              </p>
            </div>
            <div class="col-md-3 text-center">
              <img
                src="{{ url_for('static', filename='assets/report.png') }}"
                alt="Laporan Transparan"
                class="img-fluid mb-3"
                style="max-height: 120px" />
              <h5>Laporan keamanan</h5>
              <p>
                Laporan absensi tidak dapat diaudit untuk memastikan integritas.
                Admin mengelola laporan untuk menjaga keakuratan dan keaslian
                absensi.
              </p>
            </div>
          </div>
        </div>
      </section>
      <style>
        .keamanan-kecurangan {
          background-color: #fefefe;
          box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
        .keamanan-kecurangan h3 {
          font-weight: 600;
          color: #2c3e50;
        }
        .keamanan-kecurangan p {
          font-size: 0.9rem;
          color: #555;
          line-height: 1.4;
        }
        .keamanan-kecurangan h5 {
          margin-bottom: 0.5rem;
          color: #34495e;
        }
      </style>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
      <script>
        let video = document.getElementById("video");
        let canvas = document.getElementById("canvas");
        let fotoInput = document.getElementById("fotoInput");
        let ambilBtn = document.getElementById("ambilFotoBtn");
        let submitBtn = document.getElementById("submitAbsen");
        let absenModal = document.getElementById("absenModal");
        let stream = null;

        // Aktifkan webcam saat modal dibuka
        absenModal.addEventListener("shown.bs.modal", function () {
          navigator.mediaDevices
            .getUserMedia({ video: true })
            .then((s) => {
              stream = s;
              video.srcObject = stream;
            })
            .catch((err) => {
              alert("Tidak bisa mengakses kamera!");
            });
        });

        // Ambil foto manual
        ambilBtn.onclick = function () {
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          canvas.getContext("2d").drawImage(video, 0, 0);
          let dataURL = canvas.toDataURL("image/jpeg", 0.7); // 0.7 = kualitas 70%
          fotoInput.value = dataURL;
          submitBtn.disabled = false;
          ambilBtn.textContent = "Foto Diambil";
          ambilBtn.classList.remove("btn-success");
          ambilBtn.classList.add("btn-secondary");
        };

        // Reset saat modal ditutup
        absenModal.addEventListener("hidden.bs.modal", function () {
          submitBtn.disabled = true;
          ambilBtn.textContent = "Ambil Foto";
          ambilBtn.classList.remove("btn-secondary");
          ambilBtn.classList.add("btn-success");
          fotoInput.value = "";
          if (stream) {
            stream.getTracks().forEach((track) => track.stop());
            video.srcObject = null;
            stream = null;
          }
        });

        // Slider logic
        const slides = document.querySelectorAll(".slide");
        let currentIndex = 0;
        const totalSlides = slides.length;

        const prevBtn = document.getElementById("prevBtn");
        const nextBtn = document.getElementById("nextBtn");

        function showSlide(index) {
          slides.forEach((slide, i) => {
            slide.classList.toggle("active", i === index);
          });
        }

        function nextSlide() {
          currentIndex = (currentIndex + 1) % totalSlides;
          showSlide(currentIndex);
        }

        function prevSlide() {
          currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
          showSlide(currentIndex);
        }

        nextBtn.addEventListener("click", nextSlide);
        prevBtn.addEventListener("click", prevSlide);

        // Auto slide every 5 seconds
        setInterval(nextSlide, 5000);
      </script>
    </div>
  </body>
</html>
